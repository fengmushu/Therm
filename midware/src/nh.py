#y=a0+a1x+a2x^2+...+anx^n
import numpy as np
import matplotlib.pyplot as plt

# 10-45C
Tc_array   = np.array([10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45])
# Vi-Te
Vite_array  = np.array([996534, 931788, 866052, 799326, 731610, 662904, 593208, 522522, 450846, 378180, 304524, 229878, 154242, 77616, 0, -78606, -158202, -238788, -320364, -402930, -486486, -571032, -656568, -743094, -830610, -919116, -1008612, -1099098, -1190574, -1283040, -1376496, -1470942, -1566378, -1662804, -1760220, -1858626])
# Vi-Tt
Vitt_array  = np.array([-1827144, -1762398, -1696662, -1629936, -1562220, -1493514, -1423818, -1353132, -1281456, -1208790, -1135134, -1060488, -984852, -908226, -830610, -752004, -672408, -591822, -510246, -427680, -344124, -259578, -174042, -87516, 0, 88506, 178002, 268488, 359964, 452430, 545886, 640332, 735768, 832194, 929610, 1028016])
# Ra-T
Rat_array  = np.array([198710,189729,181190,173070,165350,157980,150960,144260,137850,131720,125860,120240,114860,109700,104750,100000,95642,91506,87557,83845,80299,76926,73718,70665,67759,64911,62355,59842,57446,55161,52980,50900,48913,47016,45203,43471])

n = 2 # n<5
m = len(Tc_array)

A = np.ones(m).reshape((m,1))
for i in range(n):
    A = np.hstack([A,(Tc_array**(i+1)).reshape((m,1))])

from numpy.linalg import solve 
ViTt = solve(np.dot(A.T, A), np.dot(A.T, Vitt_array.T))
ViTe = solve(np.dot(A.T, A), np.dot(A.T, Vite_array.T))
RaTe = solve(np.dot(A.T, A), np.dot(A.T, Rat_array.T))

print("Vi(Tt)", ViTt)
print("Vi(Te)", ViTe)
print("Ra(Te)", RaTe)

